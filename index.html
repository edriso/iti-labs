<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JS lab - Regex</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-lime-500 pt-10">
    <div
      class="mx-auto max-w-md bg-white rounded-lg p-2 mb-4 mt-12"
      id="error-container"
    >
      <p class="text-red-500" id="error-msg">error</p>
    </div>

    <div class="block p-6 rounded-lg shadow-lg bg-white max-w-md mx-auto">
      <form>
        <div class="form-group mb-6">
          <label
            for="exampleInputEmail"
            class="form-label inline-block mb-2 text-gray-700"
            >Email</label
          >
          <input
            type="email"
            class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-lime-600 focus:outline-none"
            id="exampleInputEmail"
            aria-describedby="emailHelp"
            placeholder="Enter valid email"
          />
        </div>
        <div class="form-group mb-6">
          <label
            for="exampleInputPassword2"
            class="form-label inline-block mb-2 text-gray-700"
            >Password</label
          >
          <input
            type="password"
            class="form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-lime-600 focus:outline-none"
            id="exampleInputPassword2"
            placeholder="8 chars, with 1 small, 1 Capital letter, 1 num"
          />
        </div>
        <button
          type="submit"
          class="w-full px-6 py-2.5 bg-lime-500 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-lime-600 hover:shadow-lg focus:bg-lime-600 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-lime-800 active:shadow-lg transition duration-150 ease-in-out"
          id="login-btn"
        >
          Sign in
        </button>
      </form>
    </div>

    <script>
      const loginBtn = document.getElementById("login-btn");
      const errorContainer = document.getElementById("error-container");
      const errorMsg = document.getElementById("error-msg");
      const email = document.querySelector("form input[type='email']");
      const password = document.querySelector("form input[type='password']");

      errorContainer.style.display = "none";

      loginBtn.addEventListener("click", (e) => {
        e.preventDefault();

        const emailVal = email.value;
        const passwordVal = password.value;

        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        /*
        (?=.*[0-9]) - Assert a string has at least one number;
        (?=.*[!@#$%^&*]) - Assert a string has at least one special character.
        */
        const passwordRegex =
          /(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9!@#$%^&*]{8,}$/;

        console.log(emailVal, emailVal.match(emailRegex));
        console.log(passwordVal, passwordVal.match(passwordRegex));

        if (!emailVal.trim()) {
          errorMsg.innerText = "Email is required";
          errorContainer.style.display = "block";
        } else if (!emailVal.match(emailRegex)) {
          errorMsg.innerText = "That is not a valid email!";
          errorContainer.style.display = "block";
        } else if (!passwordVal) {
          errorMsg.innerText = "Password is required";
          errorContainer.style.display = "block";
        } else if (!passwordVal.match(passwordRegex)) {
          errorMsg.innerText =
            "Password must be at least 8 chars, and contains 1 small letter, 1 capital letter, 1 number";
          errorContainer.style.display = "block";
        } else {
          errorContainer.style.display = "none";
          setTimeout(() => {
            alert("Welcome back!");
          }, 200);
        }
      });
    </script>
  </body>
</html>
